/* ==========================================================================
   06-BLOCKS - Reusable UI components and blocks (CUBE CSS: Block)
   ========================================================================== */

/* ===== HEADER COMPONENT ===== */
.b-header {
	position: sticky;
	top: 0;
	background-color: var(--s-color-bg-base);
	border-block-end: var(--s-border);
	z-index: var(--g-z-max);
	font-size: var(--g-font-size-100);

	nav {
		height: auto;
		align-items: stretch;
	}

	.main-nav {
		flex: 1 1 auto;
		min-width: 0;
		display: flex;
		align-items: stretch;
		gap: var(--g-space-1);
		width: 100%;
		height: 100%;
		padding-block: var(--g-space-2);

		@media (--lg) {
			grid-column: span 7;
		}

		&--explorer {
			grid-column: span 10;
		}
	}

	.user-picture {
		border-radius: var(--s-rounded);
		border: var(--s-border-secondary);
		cursor: pointer;
		height: var(--g-space-10);
		width: var(--g-space-10);
		flex-shrink: 0;
	}
}

/* ===== MAIN NAVIGATION ===== */
.b-main-navivation {
	position: relative;
	height: auto;
	width: 100%;
	color: var(--s-color-text-quaternary);

	& > .container {
		position: relative;
		align-items: center;
		background-color: currentColor;
		border: var(--s-border-secondary);
		height: 100%;
		padding-inline: var(--g-space-1-5);
		border-radius: var(--s-rounded);

		@media (--md) {
			padding-inline-end: var(--g-space-8);
		}

		/* Focus state */
		&:has([data-role="header-input-search"]:focus-within) {
			border-color: var(--s-color-border-tertiary);
		}
	}

	/* Search bar */
	.searchbar {
		position: absolute;
		inset: 0;
		padding: var(--g-space-1-5);
		padding-inline-end: var(--g-space-8);
		font-size: var(--g-font-size-200);
		color: var(--s-color-text-secondary);
		font-weight: var(--g-font-medium);

		& > input {
			height: 100%;
			width: 100%;
			background-color: transparent;
			outline: none;
		}

		&:focus-within + .b-breadcrumb {
			display: none;
		}
	}

	/* Network toggle button */
	.network-toggle {
		position: absolute;
		display: none;
		justify-content: center;
		align-items: center;
		right: 1px;
		top: 1px;
		height: calc(100% - 2px);
		padding: var(--g-space-1-5);
		border-start-end-radius: var(--g-border-radius);
		background-color: currentColor;
		cursor: pointer;
		z-index: var(--g-z-max);

		@media (--md) {
			display: flex;
		}

		& > svg {
			width: var(--g-space-5);
			height: var(--g-space-5);
			color: var(--s-color-text-tertiary);
		}

		&:hover > svg {
			color: var(--s-color-text-tertiary-hover);
		}
	}

	/* Popup dialog styles */
	& .b-popup-dialog {
		& > .inner {
			width: var(--g-space-72);
			color: var(--s-color-text-tertiary);
		}

		& header > span {
			color: var(--s-color-text-secondary);
			font-size: var(--g-font-size-100);
			font-weight: var(--g-font-semibold);
		}

		& .item {
			display: flex;
			gap: var(--g-space-1);

			& > svg {
				width: var(--g-space-4);
				height: var(--g-space-4);
			}
		}

		& .item-content {
			display: flex;
			flex-direction: column;
		}

		& .item-label {
			font-size: var(--g-font-size-50);
		}

		& .item-value {
			color: var(--s-color-text-secondary);
			font-size: var(--g-font-size-100);
			font-weight: var(--g-font-semibold);
		}
	}
}

/* ===== MAIN MENU ===== */
.b-main-menu {
	grid-column: span 3;
	height: var(--g-space-12);
	display: flex;
	flex: 0 0 auto;

	@media (--md) {
		height: auto;
	}

	/* Menu toggle button */
	& .menu-toggle {
		order: 3;
		margin-inline-start: auto;
		display: flex;
		align-items: center;
		cursor: pointer;

		& > svg {
			width: var(--g-space-5);
			height: var(--g-space-5);
			margin-inline-start: var(--g-space-4);

			@media (--lg) {
				margin-inline-start: var(--g-space-2);
			}
		}
	}

	/* Menu toggle input logic */
	& .menu-toggle-input {
		& ~ .menu-dev {
			display: none;
		}

		&:checked {
			& ~ .menu-dev {
				display: flex;
			}

			& ~ .menu-general {
				display: none;
			}
		}
	}

	/* Menu containers */
	& .menu-dev,
	& .menu-general {
		display: flex;
		justify-content: flex-end;
		height: 100%;
	}
}

/* ===== MENU LINK COMPONENT ===== */
.b-menu-link {
	&:last-child {
		margin-inline-end: 0;
	}

	.link {
		position: relative;
		display: flex;
		align-items: center;
		height: 100%;
		gap: var(--g-space-1);
		font-size: var(--g-font-size-100);
		color: var(--s-color-text-tertiary);
		margin-inline-end: var(--g-space-3);

		&:hover {
			color: var(--s-color-text-tertiary-hover);
		}

		/* Active state */
		&::after {
			content: "";
			position: absolute;
			left: 0;
			bottom: 0;
			width: 0;
			height: var(--g-space-1);
			border-radius: var(--s-rounded) var(--s-rounded) 0 0;
			background-color: var(--s-color-bg-brand-default);
			transition: width var(--g-transition-fast);
		}

		/* SVG styles */
		& > svg {
			min-width: var(--g-space-2);
			flex-shrink: 0;
			width: var(--g-space-5);
			height: var(--g-space-5);

			@media (--xl) {
				display: none;
			}

			@media (--2xl) {
				display: inline-block;
				width: var(--g-space-4-5);
				height: var(--g-space-4-5);
			}
		}

		@media (--md) {
			font-weight: var(--g-font-bold);
		}

		@media (--2xl) {
			padding-inline-end: var(--g-space-1);
			margin-inline-end: var(--g-space-6);
		}
	}

	/* Label link - display conditionnal */
	.link-label {
		@media (--md) {
			display: none;
		}

		@media (--xl) {
			display: inline;
		}
	}

	/* Link with icon - simplified styles */
	.link--icon {
		font-weight: var(--g-font-regular);
		margin-inline-end: var(--g-space-4);

		@media (--sm) {
			margin-inline-end: var(--g-space-6);
		}
	}

	/* Active state - consolidated styles */
	.link--is-active {
		color: var(--s-color-text-secondary);

		&::after {
			width: 100%;
		}

		& > svg {
			color: var(--s-color-bg-brand-default);
		}
	}
}

/* ===== BREADCRUMB COMPONENT ===== */
.b-breadcrumb {
	display: flex;
	background-color: var(--s-color-bg-surface-secondary);

	&::after {
		content: "";
		display: block;
		position: absolute;
		inset: 0;
		background-color: var(--s-color-bg-surface-secondary);
		pointer-events: none;
	}

	& > ol {
		display: flex;
		line-height: var(--g-line-height-snug);
		font-weight: var(--g-font-semibold);
		color: var(--s-color-text-primary);
	}

	.element,
	.argument,
	.query {
		display: flex;
		align-items: center;
		z-index: var(--g-z-1);
		white-space: nowrap;

		&:not(:first-child)::before {
			content: "/";
			color: var(--s-color-text-tertiary);
			padding-inline: 0.18rem;
			padding-block-start: var(--g-space-px);
			line-height: var(--g-line-height-normal);
		}

		a {
			display: inline-block;
			border: 1px solid var(--s-color-border-transparent);
			border-radius: var(--s-rounded-sm);
			padding: var(--g-space-0-5);
			min-width: var(--g-space-4);
			text-align: center;
			background-color: var(--s-color-bg-base);

			&:hover {
				background-color: var(--s-color-bg-brand-default);
				color: var(--s-color-text-base);
			}
		}
	}

	.argument {
		&:nth-child(1 of .argument)::before {
			content: ":";
		}

		a {
			background-color: var(--s-color-bg-surface-quaternary);
			color: var(--s-color-text-base);
		}
	}

	.query {
		&::before {
			content: "?";
		}

		&:nth-child(1 of .query)::before {
			content: "?";
		}

		label {
			position: relative;
			display: inline-flex;
			width: 100%;
			height: 100%;
			min-width: var(--g-space-4);
			text-align: center;
			padding-inline: var(--g-space-1);
			padding-block: var(--g-space-0-5);
			background-color: var(--s-color-bg-surface-primary);
			color: var(--s-color-text-secondary);
			border-radius: var(--s-rounded-sm);
			cursor: text;
			border: var(--s-border);

			&:focus-within,
			&:hover {
				border-color: var(--s-color-border-quaternary);
			}
		}

		input {
			background-color: var(--s-color-bg-surface-primary);
			order: 3;
			outline: none;
			max-width: 10ch;
			field-sizing: content;

			/* supports rules */
			@supports not (field-sizing: content) {
				width: 5rem !important;
			}

			/* Placeholder styling */
			&::placeholder {
				opacity: 0;
			}

			/* Placeholder shown state */
			&:placeholder-shown {
				width: var(--g-space-px);
				&::placeholder {
					color: var(--g-color-transparent);
				}
			}
		}
	}
}

/* ===== POPUP COMPONENT ===== */
.b-popup-bg,
.b-popup-dialog {
	z-index: var(--g-z-max);
	top: 0;
	right: 0;
	opacity: 0;
	visibility: hidden;
}

.b-popup-bg {
	position: fixed;
	inset: 0;
	display: flex;
	align-items: center;
	justify-content: center;
}

.b-popup-dialog {
	position: absolute;

	& > .inner {
		position: absolute;
		z-index: var(--g-z-max);
		transform: translateX(-100%);
		border-radius: var(--s-rounded);
		border: var(--s-border-secondary);
		background-color: var(--s-color-bg-base);
		padding: var(--g-space-2-5) var(--g-space-4);

		& > * + * {
			margin-block-start: var(--g-space-2-5);
		}
	}

	header {
		width: 100%;
		display: flex;
		justify-content: space-between;
		align-items: center;
		color: var(--s-color-text-secondary);

		& > svg {
			position: absolute;
			right: var(--g-space-3);
			color: var(--s-color-text-tertiary);
			cursor: pointer;

			& > svg:hover {
				color: var(--s-color-text-primary);
			}
		}
	}
}

.b-popup:checked {
	:is(& + .b-popup-bg, & ~ .b-popup-dialog) {
		opacity: 1;
		visibility: visible;
	}
}

/* ===== FORM COMPONENTS ===== */
.c-form {
	margin: var(--space-6) 0;
}

.c-form_header {
	margin-bottom: var(--space-4);
}

.c-form_input label,
.c-form_input input,
.c-form_input textarea {
	display: block;
	width: 100%;
}

.c-form_input {
	margin-bottom: var(--space-4);
}

.c-form_input:has(input:focus) label,
.c-form_input:has(textarea:focus) label {
	color: var(--color-green-600);
	font-weight: var(--font-weight-medium);
}

.c-form_input input,
.c-form_input textarea {
	margin-top: var(--space-2);
}

.c-form_input input:focus,
.c-form_input textarea:focus {
	border-color: var(--color-green-400);
	box-shadow: 0 0 0 3px rgb(96 171 150 / 0.1);
}

.c-form textarea {
	min-height: 100px;
	resize: vertical;
}

.c-form_select select:has(option[value=""]:checked) {
	color: var(--color-gray-400);
}

.c-form_description {
	margin-top: var(--space-2);
	font-size: var(--font-size-100);
	color: var(--color-gray-500);
}

.c-form_selectable {
	margin: var(--space-4) 0;
}

.c-form_selectable input {
	margin-right: var(--space-2);
}

.c-form_selectable label {
	cursor: pointer;
	user-select: none;
}

.c-form_selectable input[type="radio"],
.c-form_selectable input[type="checkbox"] {
	width: auto;
	margin-right: var(--space-2);
}

.c-form_selectable input[type="radio"]::after {
	content: "";
	display: block;
	width: 12px;
	height: 12px;
	border: 2px solid var(--color-gray-300);
	border-radius: 50%;
	background: var(--color-light);
}

.c-form_selectable input[type="checkbox"] {
	width: auto;
}

.c-form_selectable input[type="checkbox"]::after {
	content: "";
	display: block;
	width: 12px;
	height: 12px;
	border: 2px solid var(--color-gray-300);
	border-radius: var(--border-radius-sm);
	background: var(--color-light);
}

.c-form_selectable input[type="radio"]:checked::after,
.c-form_selectable input[type="checkbox"]:checked::after {
	background: var(--color-green-600);
	border-color: var(--color-green-600);
}

.c-form_selectable label:hover,
.c-form_selectable label:focus-within {
	color: var(--color-green-600);
}

.c-form_selectable {
	display: flex;
	align-items: center;
}

.c-form input[type="submit"] {
	background-color: var(--color-green-600);
	color: var(--color-light);
	border: none;
	padding: var(--space-3) var(--space-6);
	border-radius: var(--border-radius-md);
	cursor: pointer;
	font-weight: var(--font-weight-medium);
}

/* ===== ALERT COMPONENTS ===== */
.c-alert {
	margin: var(--space-6) 0;
	border: 1px solid var(--color-gray-200);
	border-radius: var(--border-radius-md);
	background-color: var(--color-light);
}

.c-alert > div > *:first-child {
	margin-top: 0;
}

.c-alert > div > *:last-child {
	margin-bottom: 0;
}

.c-alert > summary {
	cursor: pointer;
	padding: var(--space-4);
	font-weight: var(--font-weight-medium);
}

.c-alert > summary svg {
	margin-right: var(--space-2);
	width: 20px;
	height: 20px;
}

.c-alert > summary svg:last-of-type {
	display: none;
}

.c-alert[open] > summary svg:last-of-type {
	display: inline;
}

.c-alert > summary::marker,
.c-alert > summary::-webkit-details-marker {
	display: none;
}

.c-alert .c-alert {
	margin: var(--space-4) 0;
	border-left: 4px solid var(--color-gray-300);
}

.c-alert-info {
	border-left: 4px solid var(--color-blue-600);
}

.c-alert-info summary svg,
.c-alert-info summary {
	color: var(--color-blue-600);
}

.c-alert-note {
	border-left: 4px solid var(--color-blue-600);
}

.c-alert-note summary svg,
.c-alert-note summary {
	color: var(--color-blue-600);
}

.c-alert-success {
	border-left: 4px solid var(--color-green-600);
}

.c-alert-success summary svg,
.c-alert-success summary {
	color: var(--color-green-600);
}

.c-alert-warning {
	border-left: 4px solid var(--color-yellow-600);
}

.c-alert-warning summary svg,
.c-alert-warning summary {
	color: var(--color-yellow-600);
}

.c-alert-caution {
	border-left: 4px solid var(--color-red-600);
}

.c-alert-caution summary svg,
.c-alert-caution summary {
	color: var(--color-red-600);
}

.c-alert-tip {
	border-left: 4px solid var(--color-purple-600);
}

.c-alert-tip summary svg,
.c-alert-tip summary {
	color: var(--color-purple-600);
}

/* ===== LIST ITEM COMPONENT ===== */
.c-list-item {
	padding: var(--space-4);
	border: 1px solid var(--color-gray-200);
	border-radius: var(--border-radius-md);
}

.c-list-item__content {
	margin-bottom: var(--space-2);
}

.c-list-item__title {
	font-weight: var(--font-weight-semibold);
	margin-bottom: var(--space-1);
}

.c-list-item__description {
	color: var(--color-gray-600);
	font-size: var(--font-size-100);
}

.c-list-item__footer {
	margin-top: var(--space-2);
	font-size: var(--font-size-100);
	color: var(--color-gray-500);
}

.c-list-item__size {
	color: var(--color-gray-400);
}

.c-list-item__date {
	color: var(--color-gray-400);
}

/* ===== FILTER LIST COMPONENT ===== */
.c-filter-list :is(li, article) {
	margin-bottom: var(--space-4);
}

.c-filter-list:has(input[value="packages"]:checked) :is(li, article) {
	display: block;
}

.c-filter-list:has(input[value="realms"]:checked)
	:is(li, article):not([data-type="realm"]) {
	display: none;
}

.c-filter-list:has(input[value="pures"]:checked)
	:is(li, article):not([data-type="pure"]) {
	display: none;
}

.c-filter-list label:has(input:checked) {
	font-weight: var(--font-weight-semibold);
}

.c-filter-list label:has(input:checked)::after {
	content: " ✓";
	color: var(--color-green-600);
}

/* ===== RANGE COMPONENT ===== */
.c-range {
	position: relative;
}

.c-range::before {
	content: "";
	position: absolute;
	left: 0;
	right: 0;
	top: 50%;
	height: 2px;
	background: var(--color-gray-200);
	transform: translateY(-50%);
}

.c-range::after {
	content: "";
	position: absolute;
	left: 0;
	right: 0;
	top: 50%;
	height: 2px;
	background: var(--color-green-400);
	transform: translateY(-50%);
	clip-path: polygon(
		0 0,
		var(--range-value, 0%) 0,
		var(--range-value, 0%) 100%,
		0 100%
	);
}

.c-range:empty::before {
	display: none;
}

.c-range:empty::after {
	display: none;
}

/* ===== SIDEBAR COMPONENT ===== */
.c-sidebar__container:has(ul:empty) {
	display: none;
}

/* ===== TOC COMPONENT ===== */
.c-toc-expend-btn:has(#toc-expend:checked) + nav {
	display: block;
}

.c-toc-expend-btn:has(#toc-expend:checked) .c-toc-expend-btn_ico {
	transform: rotate(180deg);
}

/* ===== MAIN HEADER COMPONENT ===== */
.c-main-header:has(#sidemenu-summary:checked) + main #sidebar #sidebar-summary,
.c-main-header:has(#sidemenu-summary:checked)
	+ main
	#sidebar
	.c-sidebar__container {
	display: block;
}

/* ===== TOOLTIP COMPONENT ===== */
.c-tooltip {
	position: relative;
	display: inline-block;
}

.c-tooltip::after {
	content: attr(data-tooltip);
	position: absolute;
	bottom: 100%;
	left: 50%;
	transform: translateX(-50%);
	background: var(--color-gray-900);
	color: var(--color-light);
	padding: var(--space-2) var(--space-3);
	border-radius: var(--border-radius-sm);
	font-size: var(--font-size-100);
	white-space: nowrap;
	opacity: 0;
	pointer-events: none;
	transition: opacity var(--transition-fast);
	z-index: var(--z-layer-tooltip);
}

.c-tooltip:hover::after {
	opacity: 1;
}

/* ===== SOURCE CODE COMPONENT ===== */
.c-source-code > pre {
	margin: var(--space-6) 0;
}

.c-realm-view > pre a {
	color: var(--color-green-600);
}

.c-realm-view > pre .chroma-ln:target,
.c-source-code > pre .chroma-ln:target {
	background-color: var(--color-yellow-100);
}

.c-realm-view > pre .chroma-line:has(.chroma-ln:target),
.c-realm-view > pre .chroma-line:has(.chroma-ln:target) *,
.c-source-code > pre .chroma-line:has(.chroma-ln:target),
.c-source-code > pre .chroma-line:has(.chroma-ln:target) * {
	background-color: var(--color-yellow-100);
}

.c-realm-view > pre .chroma-ln,
.c-source-code > pre .chroma-ln {
	padding: var(--space-1) var(--space-2);
	border-radius: var(--border-radius-sm);
}

/* ===== FIELD CONTENT COMPONENT ===== */
.c-field-content {
	display: flex;
	align-items: center;
	gap: var(--space-2);
}

/* ===== SIDEMENU COMPONENT ===== */
.c-sidemenu .peer:checked + label > svg {
	transform: rotate(180deg);
}

/* ===== EMPTY STATE COMPONENT ===== */
.c-realm-view:has(.c-realm-view__btns:only-child) {
	margin-bottom: var(--space-8);
}

.c-realm-view__btns:only-child {
	margin-top: var(--space-8);
	margin-bottom: var(--space-8);
	padding: var(--space-4);
	background-color: var(--color-gray-50);
	border-radius: var(--border-radius-md);
	text-align: center;
}

/* ===== COMPORTEMENTS CONDITIONNELS DES COMPOSANTS ===== */

/* Comportements de display pour filter-list */
.c-filter-list:has(input[value="display-grid"]:checked) .c-range {
	display: grid;
	grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
	gap: var(--space-4);
}

.c-filter-list:has(input[value="display-list"]:checked) .c-range .c-list-item {
	display: flex;
	align-items: center;
	gap: var(--space-4);
}

.c-filter-list:has(input[value="display-list"]:checked) .c-list-item__content {
	flex: 1;
}

.c-filter-list:has(input[value="display-list"]:checked) .c-list-item__footer {
	text-align: right;
}

.c-filter-list:has(input[value="display-grid"]:checked) .c-list-item {
	display: block;
}

.c-filter-list:has(input[value="display-list"]:checked) .c-list-item__size {
	display: none;
}

.c-filter-list:has(input[value="display-list"]:checked) .c-list-item__date {
	display: none;
}

/* ===== ÉTATS DE DÉVELOPPEMENT ===== */

/* États du composant toc en mode dev */
.dev-mode .c-toc-expend-btn {
	display: block;
}

.dev-mode #sidebar-summary {
	display: block;
}
