{{ define "renderOverview" }}
<!-- Overview ToC -->
{{ with render .ComponentTOC }}
<aside
  class="first:mt-8 lg:first:mt-0 col-span-1 lg:col-span-3 lg:col-span-3 lg:order-2 lg:row-start-1 lg:row-span-2 relative h-full sidebar"
  aria-label="Table of Contents">
  <div class="sticky top-14 lg:pt-2 sidebar__container">
    <div id="sidebar-summary" class="max-h-screen overflow-scroll no-scrollbar bg-gray-50 lg:bg-transparent rounded-sm">
      <!-- Metadata Section -->
      {{ template "ui/overview_metadata" $ }}

      <!-- TOC Section -->
      {{ template "ui/expend_label" "On this page"}}
      <nav class="toc-nav hidden lg:block text-100 mt-2 lg:mt-0 pb-6 lg:pb-28 px-4 py-2 lg:px-0 *:pl-0">{{ . }}</nav>
    </div>
  </div>
</aside>
{{ end }}

<!-- Overview Header -->
<header class="mt-10 lg:row-start-1 row-span-1 col-span-1 lg:col-span-7 flex flex-col xl:flex-row justify-between mb-4">
  <div class="flex items-center">
    <h1 class="text-600 text-gray-900 font-bold">Package Overview</h1>
  </div>
</header>

<!-- Overview Content -->
{{ template "layout/article" .Article }}
{{ end }}

{{ define "ui/code_block" }}
{{ $id := .ID }}
{{ $content := .Content }}
{{ $language := .Language }}
{{ $doc := .Doc }}
{{ $name := .Name }}
{{ $file := .File }}
{{ $line := .Line }}
{{ $pkgPath := .PkgPath }}
{{ $prefix := .Prefix }}
{{ $prefix := .Prefix }}
<li id="{{ $id }}" class="group scroll-mt-20">
  <h3 class="inline-block font-bold text-300" id>{{ $prefix }} <a
      href="{{ $pkgPath }}$source&file={{ $file }}#L{{ $line }}" class="text-green-600 hover:underline">{{ $name }}</a>
    <a href="#{{ $id }}" class="hidden group-hover:inline-flex hover:text-green-600 align-sub"><svg
        class="w-5 h-5 shrink-0">
        <use href="#ico-link"></use>
      </svg></a>
  </h3>
  {{ if $doc }}<div class="text-gray-600 mt-1">{{ $doc }}</div>{{ end }}
  <div class="flex flex-col items-center mb-1 mt-3 w-full bg-gray-100 rounded-sm border overflow-hidden">
    <div class="flex w-full justify-between gap-2 border-b py-1 px-2 text-50 text-gray-400">
      <span class="font-mono">{{ $language }}</span>
      <span class="flex items-center gap-4">
        <button class="js-copy-btn group flex items-center gap-0.5 pt-0.5 hover:text-gray-600"
          data-copy-btn="{{ $id }}">
          {{ template "ui/copy" }}
          <span class="hidden xl:inline">Copy</span>
        </button>
        {{ if and $file $line }}
        <a href="{{ $pkgPath }}$source&file={{ $file }}#L{{ $line }}"
          class="flex items-center gap-1 pt-0.5 hover:text-gray-600">
          <svg class="w-4 h-4 shrink-0">
            <use href="#ico-code"></use>
          </svg>
          <span class="hidden xl:inline">View source</span>
        </a>
        {{ end }}
      </span>
    </div>
    <pre class="mb-0 w-full text-200 font-mono overflow-x-auto" id="{{ $id }}"
      data-copy-content="{{ $id }}">{{ highlightCode $content $language }}</pre>
  </div>
</li>
{{ end }}

{{ define "ui/overview_content" }}
<!-- README section -->
{{ if .Readme }}
<div class="mb-12" id="readme">
  <h2 class="text-400 font-bold mb-2">README</h2>
  <md-renderer class="realm-view block bg-light p-4 rounded">
    {{ render .Readme }}
  </md-renderer>
</div>
{{ end }}

<!-- Functions section -->
{{ if .Functions }}
<div class="mb-12" id="functions">
  <h2 class="inline-flex items-center gap-2 text-600 font-bold mb-5 w-full border-b pb-2"><svg class="w-6 h-6 shrink-0">
      <use href="#ico-code"></use>
    </svg> Functions</h2>
  <ul class="space-y-6">
    {{ range .Functions }}
    {{ template "ui/code_block" (dict "ID" (printf "func-%s" .Name) "Content" .Signature "Language" "go" "Doc" .Doc
    "Name" .Name "File" .File "Line" .Line "PkgPath" $.PkgPath "Prefix" "func") }}
    {{ end }}
  </ul>
</div>
{{ end }}

<!-- Constants section -->
{{ if .GroupedConsts }}
<div class="mb-12" id="constants">
  <h2 class="inline-flex items-center gap-2 text-600 font-bold mb-5 w-full"><svg class="w-6 h-6 shrink-0">
      <use href="#ico-code"></use>
    </svg> Constants</h2>
  <ul class="space-y-6">
    {{ range .GroupedConsts }}
    {{ template "ui/code_block" (dict "ID" .ID "Content" .Signature "Language" "go"
    "Doc" .Doc "Name" .Names "File" .File "Line" .Line "PkgPath"
    $.PkgPath "Prefix" "const") }}
    {{ end }}
  </ul>
</div>
{{ end }}

<!-- Variables section -->
{{ if .GroupedVars }}
<div class="mb-12" id="variables">
  <h2 class="inline-flex items-center gap-2 text-600 font-bold mb-5 w-full"><svg class="w-6 h-6 shrink-0">
      <use href="#ico-code"></use>
    </svg> Variables</h2>
  <ul class="space-y-6">
    {{ range .GroupedVars }}
    {{ template "ui/code_block" (dict "ID" .ID "Content" .Signature "Language" "go" "Doc"
    .Doc "Name" .Names "File" .File "Line" .Line "PkgPath" $.PkgPath "Prefix" "var") }}
    {{ end }}
  </ul>
</div>
{{ end }}

<!-- Types section -->
{{ if .Types }}
<div class="mb-12" id="types">
  <h2 class="inline-flex items-center gap-2 text-600 font-bold mb-5 border-b pb-2 w-full"><svg class="w-6 h-6 shrink-0">
      <use href="#ico-code"></use>
    </svg> Types</h2>
  <ul class="space-y-6">
    {{ range .Types }}
    {{ template "ui/code_block" (dict "ID" (printf "type-%s" .Name) "Content" .Signature "Language" "go" "Doc" .Doc
    "Name" .Name "File" .File "Line" .Line "PkgPath" $.PkgPath "Prefix" "type") }}
    {{ end }}
  </ul>
</div>
{{ end }}

<!-- Files section -->
{{ if .Files }}
<div class="mb-12" id="files">
  <h2 class="inline-flex items-center gap-2 text-600 font-bold mb-5 border-b pb-2 w-full"><svg class="w-6 h-6 shrink-0">
      <use href="#ico-file"></use>
    </svg> Source Files</h2>
  <ul>
    {{ range .Files }}
    <li class="border-b first:border-t">
      <a class="py-2 flex justify-between items-center px-2 text-gray-600 line-clamp-2 hover:bg-gray-100"
        href="{{ $.PkgPath }}$source&file={{ . }}">
        <span class="flex items-center gap-2">
          <svg class="w-4 h-4 shrink-0">
            <use href="#ico-file"></use>
          </svg>
          {{ . }}
        </span>
        <span class="text-gray-300">Open</span>
      </a>
    </li>
    {{ end }}
  </ul>
</div>
{{ end }}

<!-- Directories section -->
{{ if .Dirs }}
<div class="mb-12" id="directories">
  <h2 class="inline-flex items-center gap-2 text-600 font-bold mb-5 border-b pb-2 w-full"><svg class="w-6 h-6 shrink-0">
      <use href="#ico-folder"></use>
    </svg> Directories</h2>
  <ul>
    {{ range .Dirs }}
    <li class="border-b first:border-t">
      <a class="py-2 flex justify-between items-center px-2 text-gray-600 line-clamp-2 hover:bg-gray-100"
        href="{{ $.PkgPath }}/{{ . }}">
        <span class="flex items-center gap-2">
          <svg class="w-4 h-4 shrink-0">
            <use href="#ico-folder"></use>
          </svg>
          {{ . }}
        </span>
        <span class="text-gray-300">Open</span>
      </a>
    </li>
    {{ end }}
  </ul>
</div>
{{ end }}

<!-- Imports section -->
{{ if .Imports }}
<div class="mb-12" id="imports">
  <h2 class="inline-flex items-center gap-2 text-600 font-bold mb-5 border-b pb-2 w-full"><svg class="w-6 h-6 shrink-0">
      <use href="#ico-ddl"></use>
    </svg> Imports</h2>
  <ul>
    {{ range .Imports }}
    <li>
      {{ if .Link }}
      <a href="{{ .Link }}" class="text-blue-700 hover:underline font-mono" rel="noopener noreferrer ugc">
        {{ .Name }}
      </a>
      {{ else }}
      <span class="text-gray-500 font-mono">{{ .Name }}</span>
      {{ end }}
    </li>
    {{ end }}
  </ul>
</div>
{{ end }}

{{ if and (not .Readme) (not .Functions) (not .Files) }}
<div class="text-gray-400 italic">No documentation, functions or files found in this package.</div>
{{ end }}
{{ end }}

{{ define "ui/overview_metadata" }}
{{ if .PackageInfo }}
<div class="mb-6 p-4 bg-gray-50 rounded-lg border">
  <h3 class="text-sm font-semibold text-gray-700 mb-3">Package Info</h3>

  <!-- Module -->
  {{ if .PackageInfo.Module }}
  <div class="mb-2">
    <span class="text-xs text-gray-500">Module:</span>
    <div class="text-xs font-mono text-gray-700 break-all">{{ .PackageInfo.Module }}</div>
  </div>
  {{ end }}

  <!-- Version -->
  {{ if .PackageInfo.GnoVersion }}
  <div class="mb-2">
    <span class="text-xs text-gray-500">Gno Version:</span>
    <div class="text-xs font-mono text-gray-700">{{ .PackageInfo.GnoVersion }}</div>
  </div>
  {{ end }}

  <!-- Package Type -->
  {{ if .PackageInfo.PackageType }}
  <div class="mb-2">
    <span class="text-xs text-gray-500">Type:</span>
    <div class="text-xs font-mono text-gray-700">{{ .PackageInfo.PackageType }}</div>
  </div>
  {{ end }}

  <!-- Creator -->
  <div class="mb-2">
    <span class="text-xs text-gray-500">Creator:</span>
    {{ if .PackageInfo.Creator }}
    <div class="text-xs font-mono text-gray-700">
      <a href="/u/{{ .PackageInfo.Creator }}" class="text-blue-600 hover:text-blue-800 hover:underline"
        title="{{ .PackageInfo.Creator }}">
        Gnome {{ truncateMiddle .PackageInfo.Creator 4 }}
      </a>
    </div>
    {{ else }}
    <div class="text-xs font-mono text-gray-500 italic">
      No Creator
    </div>
    {{ end }}
  </div>

  <!-- Height -->
  {{ if and .PackageInfo.Height (gt .PackageInfo.Height 0) }}
  <div class="mb-2">
    <span class="text-xs text-gray-500">Block Height:</span>
    <div class="text-xs font-mono text-gray-700">{{ .PackageInfo.Height }}</div>
  </div>
  {{ end }}

  <!-- Badges -->
  <div class="flex flex-wrap gap-1 mt-3">
    {{ if .PackageInfo.Draft }}
    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
      Draft
    </span>
    {{ else }}
    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
      Published
    </span>
    {{ end }}
    {{ if .PackageInfo.Private }}
    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800">
      Private
    </span>
    {{ else }}
    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
      Public
    </span>
    {{ end }}
    {{ if .PackageInfo.License }}
    <a href="{{ $.PkgPath }}$source&file=LICENSE.md"
      class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 hover:bg-blue-200">
      {{ .PackageInfo.License }}
    </a>
    {{ else }}
    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-600">
      No License
    </span>
    {{ end }}
    {{ if .PackageInfo.HasTests }}
    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
      Tests
    </span>
    {{ else }}
    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800">
      No Tests
    </span>
    {{ end }}
    {{ if .PackageInfo.HasReadme }}
    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800">
      Documentation
    </span>
    {{ else }}
    <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800">
      No Documentation
    </span>
    {{ end }}
  </div>
</div>
{{ end }}

<!-- Statistics -->
<div class="mb-6 p-4 bg-gray-50 rounded-lg border">
  <h3 class="text-sm font-semibold text-gray-700 mb-3">Statistics</h3>

  <div class="space-y-2 text-xs">
    <div class="flex justify-between">
      <span class="text-gray-500">Files:</span>
      <span class="font-mono text-gray-700">{{ .FileCounter }}</span>
    </div>
    <div class="flex justify-between">
      <span class="text-gray-500">Functions:</span>
      <span class="font-mono text-gray-700">{{ len .Functions }}</span>
    </div>
    <div class="flex justify-between">
      <span class="text-gray-500">Types:</span>
      <span class="font-mono text-gray-700">{{ len .Types }}</span>
    </div>
    <div class="flex justify-between">
      <span class="text-gray-500">Directories:</span>
      <span class="font-mono text-gray-700">{{ len .Dirs }}</span>
    </div>
    <div class="flex justify-between">
      <span class="text-gray-500">Imports:</span>
      <span class="font-mono text-gray-700">{{ len .Imports }}</span>
    </div>
  </div>
</div>
{{ end }}