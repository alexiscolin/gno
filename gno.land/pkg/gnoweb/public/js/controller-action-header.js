function m(r,t=250){let e;return function(...n){e!==void 0&&clearTimeout(e),e=setTimeout(()=>r.apply(this,n),t)}}function p(r){return r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function c(r){return r=r.replace(/-([a-z])/g,(t,e)=>e.toUpperCase()),r.charAt(0).toLowerCase()+r.slice(1)}function a(r,t){return r.matches(t)?r:r.querySelector(t)}function l(r,t){let e=[];return r.matches(t)&&e.push(r),e.push(...Array.from(r.querySelectorAll(t))),e}var i=class{element;initialized=!1;DOM={};controllerName;controllerKebabName;constructor(t){this.element=t,this.controllerName=c(this.getControllerName()),this.controllerKebabName=p(this.controllerName),this.init()}init(){this.initialized||(this.connect(),this.setupActions(),this.initialized=!0)}initializeDOM(t){return this.DOM={el:this.element,...t},t}getDOMElement(t){return Array.isArray(this.DOM[t])?this.DOM[t][0]:this.DOM[t]}getDOMArray(t){let e=this.DOM[t];return e?Array.isArray(e)?e:[e]:[]}getTarget(t,e){let n=e||this.element,s=`[data-${this.controllerKebabName}-target="${t}"]`;return a(n,s)}getTargets(t,e){let n=e||this.element;return l(n,`[data-${this.controllerKebabName}-target="${t}"]`)}getGlobalTarget(t){return document.querySelector(`[data-${this.controllerKebabName}-target="${t}"]`)}setupActions(){l(this.element,"[data-action]").forEach(e=>{let n=e.getAttribute("data-action");if(n){let[s,o]=n.split("->"),[M,f]=o.split("#");if(M===this.controllerKebabName){let d=this[f];typeof d=="function"&&e.addEventListener(s,u=>{let b=this.extractActionParams(e);u.params=b,d.call(this,u)})}}})}extractActionParams(t){let e={};for(let[n,s]of Object.entries(t.dataset))if(n.startsWith(this.controllerName)&&n.endsWith("Param")){let o=c(n.slice(this.controllerName.length,-5));e[o]=this.parseParamValue(s)}return e}parseParamValue(t){if(t==null||t.trim()==="")return"";let e=t.trim();if(/^(true|false)$/i.test(e))return e.toLowerCase()==="true";if(/^[+-]?\d+(\.\d+)?([eE][+-]?\d+)?$/.test(e)){let n=Number(e);if(!Number.isNaN(n)&&Number.isFinite(n))return n}if(/^(null|undefined)$/i.test(e))return e.toLowerCase()==="null"?null:void 0;if(/^[{[]/.test(e)||/^".*"$/.test(e))try{return JSON.parse(e)}catch{}return t}getValue(t,e){let n=`data-${this.controllerKebabName}-${t}-value`,s=e||this.element,o=a(s,`[${n}]`);return o&&o.getAttribute(n)||""}setValue(t,e,n){let s=`data-${this.controllerKebabName}-${t}-value`;(n||this.element).setAttribute(s,e)}hasValue(t,e){let n=`data-${this.controllerKebabName}-${t}-value`,s=e||this.element;return a(s,`[${n}]`)!==null}on(t,e){document.addEventListener(t,e)}dispatch(t,e={}){let n=new CustomEvent(t,{detail:e,bubbles:!0});document.dispatchEvent(n)}getControllerName(){return this.constructor.name.replace(/^_/,"").replace(/Controller$/,"")}};var h={Fast:"fast",Secure:"secure"},g=class extends i{connect(){this.on("controllers:ready",()=>{this._restoreMode(),this._restoreAddress()})}restoreValue(t,e,n){if(e){let s=localStorage.getItem(t);s&&(e.value=s,n(s))}}_restoreMode(){let t=this.getTarget("mode");this.restoreValue("actionCmdMode",t,e=>{(e===h.Fast||e===h.Secure)&&this.dispatch("mode:changed",{mode:e})})}_restoreAddress(){let t=this.getTarget("address");this.restoreValue("actionAddressInput",t,e=>{this.dispatch("address:changed",{address:e})})}_debouncedAddressUpdate=m(t=>{let e=t.value;localStorage.setItem("actionAddressInput",e),this.dispatch("address:changed",{address:e})},50);updateMode(t){let n=t.target.value;localStorage.setItem("actionCmdMode",n),this.dispatch("mode:changed",{mode:n})}updateAddress(t){let e=t.target;this._debouncedAddressUpdate(e)}};export{g as ActionHeaderController,h as ActionModeValues};
