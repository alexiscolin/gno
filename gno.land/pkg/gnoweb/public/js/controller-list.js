function h(r,t=250){let e;return function(...n){e!==void 0&&clearTimeout(e),e=setTimeout(()=>r.apply(this,n),t)}}function E(r){return r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function p(r){return r=r.replace(/-([a-z])/g,(t,e)=>e.toUpperCase()),r.charAt(0).toLowerCase()+r.slice(1)}function m(r,t){return r.matches(t)?r:r.querySelector(t)}function g(r,t){let e=[];return r.matches(t)&&e.push(r),e.push(...Array.from(r.querySelectorAll(t))),e}var d=class{element;initialized=!1;DOM={};controllerName;controllerKebabName;constructor(t){this.element=t,this.controllerName=p(this.getControllerName()),this.controllerKebabName=E(this.controllerName),this.init()}init(){this.initialized||(this.connect(),this.setupActions(),this.initialized=!0)}initializeDOM(t){return this.DOM={el:this.element,...t},t}getDOMElement(t){return Array.isArray(this.DOM[t])?this.DOM[t][0]:this.DOM[t]}getDOMArray(t){let e=this.DOM[t];return e?Array.isArray(e)?e:[e]:[]}getTarget(t,e){let n=e||this.element,s=`[data-${this.controllerKebabName}-target="${t}"]`;return m(n,s)}getTargets(t,e){let n=e||this.element;return g(n,`[data-${this.controllerKebabName}-target="${t}"]`)}getGlobalTarget(t){return document.querySelector(`[data-${this.controllerKebabName}-target="${t}"]`)}setupActions(){g(this.element,"[data-action]").forEach(e=>{let n=e.getAttribute("data-action");if(n){let[s,i]=n.split("->"),[a,l]=i.split("#");if(a===this.controllerKebabName){let c=this[l];typeof c=="function"&&e.addEventListener(s,o=>{let u=this.extractActionParams(e);o.params=u,c.call(this,o)})}}})}extractActionParams(t){let e={};for(let[n,s]of Object.entries(t.dataset))if(n.startsWith(this.controllerName)&&n.endsWith("Param")){let i=p(n.slice(this.controllerName.length,-5));e[i]=this.parseParamValue(s)}return e}parseParamValue(t){if(t==null||t.trim()==="")return"";let e=t.trim();if(/^(true|false)$/i.test(e))return e.toLowerCase()==="true";if(/^[+-]?\d+(\.\d+)?([eE][+-]?\d+)?$/.test(e)){let n=Number(e);if(!Number.isNaN(n)&&Number.isFinite(n))return n}if(/^(null|undefined)$/i.test(e))return e.toLowerCase()==="null"?null:void 0;if(/^[{[]/.test(e)||/^".*"$/.test(e))try{return JSON.parse(e)}catch{}return t}getValue(t,e){let n=`data-${this.controllerKebabName}-${t}-value`,s=e||this.element,i=m(s,`[${n}]`);return i&&i.getAttribute(n)||""}setValue(t,e,n){let s=`data-${this.controllerKebabName}-${t}-value`;(n||this.element).setAttribute(s,e)}hasValue(t,e){let n=`data-${this.controllerKebabName}-${t}-value`,s=e||this.element;return m(s,`[${n}]`)!==null}on(t,e){document.addEventListener(t,e)}dispatch(t,e={}){let n=new CustomEvent(t,{detail:e,bubbles:!0});document.dispatchEvent(n)}getControllerName(){return this.constructor.name.replace(/^_/,"").replace(/Controller$/,"")}};var f=class r extends d{static STORAGE_KEY="gno_display_mode";static LOADING_CLASS="u-is-loading";connect(){if(this.initializeDOM({range:this.getTarget("range"),packagesCount:this.getTarget("packages-count"),realmsCount:this.getTarget("realms-count"),pureCount:this.getTarget("pure-count")}),this.currentFilter="",!this.getDOMElement("range")){console.warn("ListController: Range element not found");return}this._initializeItems(),this._restoreDisplayMode(),requestAnimationFrame(()=>{this.element?.classList.remove(r.LOADING_CLASS)})}_initializeItems(){let t=this.getDOMElement("range");if(!t)return;let e=this.getTargets("range-title");this.items=Array.from(t.children).map((n,s)=>{let i=e[s],a=this.getValue("type",n);return{element:n,title:(i?.textContent||"").toLowerCase(),type:a}}),this.sortedItems=[...this.items]}_restoreDisplayMode(){let t=localStorage.getItem(r.STORAGE_KEY);if(!t)return;let e=this.element?.querySelector(`input[name="display-mode"][value="${t}"]`);e&&!e.checked&&(e.checked=!0)}_updateCounts(t){let e=this.getDOMElement("packagesCount"),n=this.getDOMElement("realmsCount"),s=this.getDOMElement("pureCount"),i=t.reduce((o,u)=>(o[u.type]=(o[u.type]||0)+1,o),{}),a=i.realm||0,l=i.pure||0,c=a+l;e&&(e.textContent=c.toString()),n&&(n.textContent=a.toString()),s&&(s.textContent=l.toString())}_updateDOM(){let t=this.getDOMElement("range");if(!t)return;let e=this._filterItems(),n=document.createDocumentFragment();e.forEach(s=>n.appendChild(s.element)),t.textContent="",t.appendChild(n),this._updateCounts(e)}_debouncedSearch=h(t=>{this.currentFilter=t.toLowerCase(),this._updateDOM()},150);_sortItems(){this.sortedItems.reverse()}_filterItems(){return this.currentFilter?this.sortedItems.filter(t=>t.title.includes(this.currentFilter)):this.sortedItems}search(t){let e=t.target;this._debouncedSearch(e.value)}orderChange(t){this._sortItems(),this._updateDOM()}displayModeChange(t){let e=t.target;localStorage.setItem(r.STORAGE_KEY,e.value)}};export{f as ListController};
