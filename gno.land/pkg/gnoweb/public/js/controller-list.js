function h(r,e=250){let t;return function(...n){t!==void 0&&clearTimeout(t),t=setTimeout(()=>r.apply(this,n),e)}}function E(r){return r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function p(r){return r=r.replace(/-([a-z])/g,(e,t)=>t.toUpperCase()),r.charAt(0).toLowerCase()+r.slice(1)}function m(r,e){return r.matches(e)?r:r.querySelector(e)}function g(r,e){let t=[];return r.matches(e)&&t.push(r),t.push(...Array.from(r.querySelectorAll(e))),t}var d=class{element;initialized=!1;DOM={};controllerName;controllerKebabName;constructor(e){this.element=e,this.controllerName=p(this.getControllerName()),this.controllerKebabName=E(this.controllerName),this.init()}init(){this.initialized||(this.connect(),this.setupActions(),this.initialized=!0)}initializeDOM(e){return this.DOM={el:this.element,...e},e}getDOMElement(e){return Array.isArray(this.DOM[e])?this.DOM[e][0]:this.DOM[e]}getDOMArray(e){let t=this.DOM[e];return t?Array.isArray(t)?t:[t]:[]}getTarget(e,t){let n=t||this.element,s=`[data-${this.controllerKebabName}-target="${e}"]`;return m(n,s)}getTargets(e,t){let n=t||this.element;return g(n,`[data-${this.controllerKebabName}-target="${e}"]`)}getGlobalTarget(e){return document.querySelector(`[data-${this.controllerKebabName}-target="${e}"]`)}setupActions(){g(this.element,"[data-action]").forEach(t=>{let n=t.getAttribute("data-action");if(n){let[s,i]=n.split("->"),[a,l]=i.split("#");if(a===this.controllerKebabName){let c=this[l];typeof c=="function"&&t.addEventListener(s,o=>{let u=this.extractActionParams(t);o.params=u,c.call(this,o)})}}})}extractActionParams(e){let t={};for(let[n,s]of Object.entries(e.dataset))if(n.startsWith(this.controllerName)&&n.endsWith("Param")){let i=p(n.slice(this.controllerName.length,-5));t[i]=this.parseParamValue(s)}return t}parseParamValue(e){if(e==null||e.trim()==="")return"";let t=e.trim();if(/^(true|false)$/i.test(t))return t.toLowerCase()==="true";if(/^[+-]?\d+(\.\d+)?([eE][+-]?\d+)?$/.test(t)){let n=Number(t);if(!Number.isNaN(n)&&Number.isFinite(n))return n}if(/^(null|undefined)$/i.test(t))return t.toLowerCase()==="null"?null:void 0;if(/^[{[]/.test(t)||/^".*"$/.test(t))try{return JSON.parse(t)}catch{}return e}getValue(e,t){let n=`data-${this.controllerKebabName}-${e}-value`,s=t||this.element,i=m(s,`[${n}]`);return i&&i.getAttribute(n)||""}setValue(e,t,n){let s=`data-${this.controllerKebabName}-${e}-value`;(n||this.element).setAttribute(s,t)}hasValue(e,t){let n=`data-${this.controllerKebabName}-${e}-value`,s=t||this.element;return m(s,`[${n}]`)!==null}on(e,t){document.addEventListener(e,t)}dispatch(e,t={}){let n=new CustomEvent(e,{detail:t,bubbles:!0});document.dispatchEvent(n)}getControllerName(){return this.constructor.name.replace(/^_/,"").replace(/Controller$/,"")}};var f=class r extends d{static STORAGE_KEY="gno_display_mode";static LOADING_CLASS="is-loading";connect(){if(this.initializeDOM({range:this.getTarget("range"),packagesCount:this.getTarget("packages-count"),realmsCount:this.getTarget("realms-count"),pureCount:this.getTarget("pure-count")}),this.currentFilter="",!this.getDOMElement("range")){console.warn("ListController: Range element not found");return}this._initializeItems(),this._restoreDisplayMode(),requestAnimationFrame(()=>{this.element?.classList.remove(r.LOADING_CLASS)})}_initializeItems(){let e=this.getDOMElement("range");if(!e)return;let t=this.getTargets("range-title");this.items=Array.from(e.children).map((n,s)=>{let i=t[s],a=this.getValue("type",n);return{element:n,title:(i?.textContent||"").toLowerCase(),type:a}}),this.sortedItems=[...this.items]}_restoreDisplayMode(){let e=localStorage.getItem(r.STORAGE_KEY);if(!e)return;let t=this.element?.querySelector(`input[name="display-mode"][value="${e}"]`);t&&!t.checked&&(t.checked=!0)}_updateCounts(e){let t=this.getDOMElement("packagesCount"),n=this.getDOMElement("realmsCount"),s=this.getDOMElement("pureCount"),i=e.reduce((o,u)=>(o[u.type]=(o[u.type]||0)+1,o),{}),a=i.realm||0,l=i.pure||0,c=a+l;t&&(t.textContent=c.toString()),n&&(n.textContent=a.toString()),s&&(s.textContent=l.toString())}_updateDOM(){let e=this.getDOMElement("range");if(!e)return;let t=this._filterItems(),n=document.createDocumentFragment();t.forEach(s=>n.appendChild(s.element)),e.textContent="",e.appendChild(n),this._updateCounts(t)}_debouncedSearch=h(e=>{this.currentFilter=e.toLowerCase(),this._updateDOM()},150);_sortItems(){this.sortedItems.reverse()}_filterItems(){return this.currentFilter?this.sortedItems.filter(e=>e.title.includes(this.currentFilter)):this.sortedItems}search(e){let t=e.target;this._debouncedSearch(t.value)}orderChange(e){this._sortItems(),this._updateDOM()}displayModeChange(e){let t=e.target;localStorage.setItem(r.STORAGE_KEY,t.value)}};export{f as ListController};
